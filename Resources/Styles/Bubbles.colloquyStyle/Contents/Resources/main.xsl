<xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">	<xsl:output omit-xml-declaration="yes" indent="yes" />	<xsl:template match="event">		<div class="event">			<xsl:copy-of select="message/child::node()" />		</div>	</xsl:template>	<xsl:template match="envelope">		<xsl:variable name="messageClass">			<xsl:choose>				<xsl:when test="sender/@self = 'yes'">					<xsl:text>selfMessage</xsl:text>				</xsl:when>				<xsl:otherwise>					<xsl:text>message</xsl:text>				</xsl:otherwise>			</xsl:choose>		</xsl:variable>		<xsl:variable name="bubbleClass">			<xsl:choose>				<xsl:when test="sender/@self = 'yes'">					<xsl:text>rightBubble</xsl:text>				</xsl:when>				<xsl:otherwise>					<xsl:text>leftBubble</xsl:text>				</xsl:otherwise>			</xsl:choose>		</xsl:variable>		<table id="{@count}" class="{$messageClass}" cellpadding="0" cellspacing="0">		<tr>			<xsl:choose>				<xsl:when test="sender/@self = 'yes'">					<td class="gutter"></td>				</xsl:when>				<xsl:otherwise>					<td class="icon"></td>				</xsl:otherwise>			</xsl:choose>			<td>				<table class="{$bubbleClass}" cellpadding="0" cellspacing="0">				<tr>					<td class="topLeft"></td>					<td class="center" rowspan="2">						<div class="text"><xsl:copy-of select="message/child::node()" /></div>					</td>					<td class="topRight"></td>				</tr>				<tr>					<td class="Left"></td>					<td class="Right"></td>				</tr>				<tr>					<td class="bottomLeft"></td>					<td class="bottom"></td>					<td class="bottomRight"></td>				</tr>				</table>			</td>			<xsl:choose>				<xsl:when test="sender/@self = 'yes'">					<td class="icon"></td>				</xsl:when>				<xsl:otherwise>					<td class="gutter" rowspan="2"></td>				</xsl:otherwise>			</xsl:choose>		</tr>		<xsl:if test="sender/@self != 'yes'">			<tr>				<td colspan="2" class="sender"><xsl:value-of select="sender" /></td>			</tr>		</xsl:if>		</table>	</xsl:template></xsl:transform>